---
# extra_env_vars variable should be formed as:
# extra_env_vars: "--extra-env-vars key=value --extra-env-vars key2=value2"
validations_list:
  compute:
    - nova-status:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
  clients:
    - openstack-endpoints:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
  network:
    - undercloud-neutron-sanity-check:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
  security:
    - tls-everywhere-prep:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - tls-everywhere-pre-deployment:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - tls-everywhere-post-deployment:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
  validation:
    - check-cpu:
        negative_results:
          extra_args: "--extra-vars minimal_cpu_count=20000"
        extra_args: "--extra-vars minimal_cpu_count=2"
        extra_env_args: "--extra-env-vars ANSIBLE_STDOUT_CALLBACK=default {{ extra_env_vars | default('') }}"
    - 512e:
        extra_args: ""
        extra_env_args: ""
    - check-ram:
        negative_results:
          extra_args: "--extra-vars minimal_ram_gb=2000000"
        extra_args: "--extra-vars minimal_ram_gb=2"
        extra_env_args: "--extra-env-vars ANSIBLE_STDOUT_CALLBACK=default {{ extra_env_vars | default('') }}"
  tripleo:
    - undercloud-process-count:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - tripleo-latest-packages-version:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - check-for-dangling-images:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
  baremetal:
    - collect-flavors-and-verify-profiles:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - default-node-count:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - dhcp-introspection:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - dhcp-provisioning:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - ironic-boot-configuration:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - node-disks:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
    - node-health:
        extra_args: ""
        extra_env_args: "{{ extra_env_vars | default('') }}"
validations_group:
  compute:
    - compute
  network:
    - network

validation_metadata:
  group:
    - no-op
    - prep
  category:
    - storage
    - container
  product:
    - tripleo

validation_list_formats:
  - csv
  - json
  - table
  - value
  - yaml

# Entire catalogue of validations to be executed in OVB environment
# extra_env_args and extra_args are shared for the execution
# Included validations will be sorted alphabetically.
validation_catalogue:
  extra_args: ""
  extra_env_args: "{{ extra_env_vars | default('') }}"
  full_list:
    - 512e
    - ceph-dependencies-installed
    - check-cpu
    - check-disk-space
    - check-disk-space-pre-upgrade
    - check-for-dangling-images
    - check-ftype
    - check-network-gateway
    - check-ntp-reachability
    - check-ram
    - check-rsyslog
    - check-selinux-mode
    - compute-tsx
    - container-status
    - controller-token
    - controller-ulimits
    - ctlplane-ip-range
    - dhcp-introspection
    - dhcp-provisioning
    - dns
    - fips-enabled
    - healthcheck-service-status
    - image-serve
    - mysql-open-files-limit
    - neutron-sanity-check
    - no-op
    - nova-event-callback
    - nova-svirt
    - ntp
    - openshift-nw-requirements
    - openstack-endpoints
    - overcloud-service-status
    - rabbitmq-limits
    - repos
    - service-status
    - tripleo-latest-packages-version
    - undercloud-disabled-services
    - undercloud-disk-space
    - undercloud-disk-space-pre-upgrade
    - undercloud-ipa-server-check
    - undercloud-neutron-sanity-check
    - undercloud-process-count
    - validate-selinux

# Following validations are disabled for purposes of catalogue testing

#    - ceilometerdb-size # Not present on the OVB deployment
#    - system-encoding # Not present on the OVB deployment
#    - ceph-ansible-installed # Not present on the OVB deployment
#    - haproxy # Not present on the OVB deployment
#    - no-op-firewall-nova-driver # Not present on the OVB deployment
#    - containerized-undercloud-docker # Not present on the OVB deployment

# Hostname prerequisites are not met

#    - ceph-health
#    - ovs-dpdk-pmd-cpus-check

# General validation superceded by 'tripleo-latest-packages-version'
#    - check-latest-packages-version

# Failing due to bugs
#    - ceph-pg
#    - check-uc-hostname
#    - collect-flavors-and-verify-profiles
#    - default-node-count
#    - ironic-boot-configuration
#    - network-environment
#    - nova-status
#    - node-health
#    - node-disks
#    - stack-health
#    - switch-vlans
#    - undercloud-heat-purge-deleted

# Real issues detedte by validations but not relevant
#    - check-rhsm-version
#    - check-undercloud-conf
#    - openshift-hw-requirements
#    - pacemaker-status
#    - stonith-exists
#    - tls-everywhere-post-deployment
#    - tls-everywhere-pre-deployment
#    - tls-everywhere-prep
#    - undercloud-debug
#    - undercloud-service-status
#
# List of dictionaries for testing 4 different versions of file-to-run the CLI file command
# Each dictionary consists of different options for inclusion and exclusion
# validations/groups/categories/products
test_arguments_run_from_file:
  # 1st valid file
  # expected rc is 0
  - validation:
      - check-cpu
    validation_group: []
    validation_category: []
    validation_product: []
    exclude_validation:
    exclude_validation_group: []
    exclude_validation_category: []
    exclude_validation_product:
      - tripleo
    validation-dir:
    extra_vars:
      minimal_cpu_count: 2
  # 2nd valid file with 1 non-existent validation
  # networking group should be run, expected rc is 1 due to the failing
  # validations
  - validation:
      - check-cpu
      - i-dont-exist
    validation_group: []
    validation_category:
      - compute
      - networking
    validation_product: []
    exclude_validation:
      - fips-enabled
    exclude_validation_group:
      - prep
    exclude_validation_category:
      - compute
    exclude_validation_product:
      - rabbitmq
      - tripleo
    limit_hosts:
      limit: [undercloud-0]
  #  3rd valid file testing the Invalid operation: no validation to run
  #  expected rc is 1
  - validation:
      - i-dont-exist
    validation_group: []
    validation_category: []
    validation_product: []
    exclude_validation:
      - fips-enabled
    exclude_validation_group:
      - prep
    exclude_validation_category:
      - compute
    exclude_validation_product:
      - rabbitmq
      - tripleo
  #  4th valid file, testing the proper inclusion and exclusion
  #  only networking group should run (except the dns and the ntp validations)
  # expected rc is 1 due to the failed check-cpu validation
  - validation:
      - check-cpu
    validation_group:
    validation_category:
      - networking
    validation_product:
      - tripleo
    exclude_validation:
      - fips-enabled
      - dns
      - ntp
    exclude_validation_group:
    exclude_validation_category:
    exclude_validation_product:
      - rabbitmq
      - tripleo
    extra_vars:
      minimal_cpu_count: 8000
